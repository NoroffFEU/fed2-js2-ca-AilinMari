import{a as m}from"./authGuard-C2GFzsuy.js";import{S as g}from"./logoutHandler-XduYXRLY.js";let d=new g;const p=new URL(window.location.href),a=p.searchParams.get("id");async function y(t){try{const e=await d.getPostById(t);console.log("Post data:",e.data),f(e.data)}catch(e){console.error("Error fetching post data:",e),alert("Failed to fetch post data. Please try again.")}}function f(t){document.getElementById("post-title").value=t.title,document.getElementById("post-body").value=t.body,t.media&&(document.getElementById("post-image-url").value=t.media.url||"",document.getElementById("post-image-alt").value=t.media.alt||"Image"),document.getElementById("post-tags").value=t.tags?t.tags.join(", "):""}async function I(){if(!localStorage.getItem("token")){alert("You must be logged in to update a post."),window.location.href="/auth/login/";return}if(!a){console.error("Post ID not found in the URL.");return}const e=document.getElementById("post-title").value.trim(),r=document.getElementById("post-body").value.trim(),l=document.getElementById("post-tags").value.trim(),s=document.getElementById("post-image-url").value.trim(),i=document.getElementById("post-image-alt").value.trim()||"Image";if(!e||!r){alert("Title and body are required fields.");return}const u=l?l.split(",").map(o=>o.trim()):[],c=s?{url:s,alt:i}:null;try{const o=await d.updatePost(a,e,r,u,c);console.log("Post updated successfully:",o),window.location.href="/post/?id="+o.data.id}catch(o){console.error("Error updating post:",o),alert("Failed to update post. Please try again.")}}a&&y(a);m();const n=document.forms.updatePost;n?n.addEventListener("submit",async t=>{t.preventDefault();try{await I(t),n.reset()}catch(e){console.error("Error during post update:",e)}}):console.error("Form with name 'updatePost' not found.");
